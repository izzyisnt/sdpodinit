#!/bin/bash
set -euo pipefail

if [[ $# -ne 1 ]]; then
  echo "❌  usage: $0 <target_name>"
  exit 1
fi

TARGET=$1
DEST_DIR="/root/SurfDock/data/eval_sample_dirs/test_samples/${TARGET}"

echo "📦  Preparing SurfDock inputs for   $TARGET"
echo "🔸 destination directory           $DEST_DIR"
mkdir -p "$DEST_DIR"

# ---------- sanity checks ----------
[[ -f ligand.sdf   ]] || { echo "❌ ligand.sdf not found";   exit 1; }
[[ -f protein.pdb  ]] || { echo "❌ protein.pdb not found";  exit 1; }

# ---------- copy & rename ----------
cp ligand.sdf      "$DEST_DIR/${TARGET}_ligand.sdf"
echo "✅ copied ligand.sdf      → ${TARGET}_ligand.sdf"

if [[ -f ligand.mol2 ]]; then
  cp ligand.mol2    "$DEST_DIR/${TARGET}_ligand.mol2"
  echo "✅ copied ligand.mol2    → ${TARGET}_ligand.mol2"
fi

cp protein.pdb     "$DEST_DIR/${TARGET}_protein_processed.pdb"
echo "✅ copied protein.pdb    → ${TARGET}_protein_processed.pdb"

echo "🎉  SurfDock inputs ready in $DEST_DIR"
